import e,{useLayoutEffect as t,useEffect as i,useRef as n,useState as o}from"react";const s="undefined"!=typeof window,r=s?t:i,a=Object.create({});function l(e){return!!a[e]&&a[e][window.location.href]||null}function c(e,t){if(l(t))return l(t)||100;let i=e;if(i.getBoundingClientRect().width<32)for(i=i.parentNode;"BODY"!==i.tagName&&i.getBoundingClientRect().width<=32;)i=i.parentNode;return Math.ceil(i.getBoundingClientRect().width/window.innerWidth*100)}const d="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype,u=s&&window.IntersectionObserver;const m=e=>Object.entries(e).map(([e,t])=>`${t} ${e}w`).join(", ");function g(t){const i=n(null),s=n(null),g=t.aspectRatio?`${100/t.aspectRatio}%`:t.height,p="eager"===t.loading||t.critical,h=!!l(t.src),[w,f]=o({sizes:h?l(t.src):t.sizes||100,isVisible:h||p||d||!u,shouldFadeIn:!h||t.fadeIn,imgLoaded:h||!1}),b=e=>f(t=>({...t,...e}));function y(){var e,i;h||(e=t.src,i=Number(w.sizes),a[e]={...a[e]||{},[window.location.href]:i},b({imgLoaded:!0}))}r(()=>{h||b({sizes:t.sizes||c(s.current,t.src)});const e=!w.isVisible&&function(e,t){const i=new window.IntersectionObserver(([n])=>{(n.isIntersecting||n.intersectionRatio>0)&&(i.unobserve(e),t())},{rootMargin:"200px"});return i.observe(e),i}(s.current,()=>b({isVisible:!0}));if(p){const e=i.current;e&&e.complete&&y()}return()=>{e&&e.unobserve(s.current)}},[]);const v=!w.shouldFadeIn||w.imgLoaded,z={position:"absolute",top:0,left:0,width:"100%",height:"100%",objectFit:t.fit,objectPosition:t.position},I={opacity:v?1:0,transition:w.shouldFadeIn?`opacity ${t.durationFadeIn}ms`:"none",...t.imgStyle},S={transition:t.transparent&&w.shouldFadeIn?`opacity ${t.durationFadeIn}ms`:void 0,transitionDelay:t.transparent?"0":`${t.durationFadeIn}ms`},C={opacity:w.imgLoaded?0:1,...w.shouldFadeIn&&S,...t.imgStyle,...t.placeholderStyle};return e.createElement("div",{style:{position:"relative",overflow:"hidden"},className:t.className},e.createElement("div",{style:{width:"100%",paddingBottom:g,...t.sizerStyle},ref:s,className:t.sizerClass}),t.bgColor&&e.createElement("div",{className:t.placeholderClass,style:{backgroundColor:t.bgColor,...z,...C}}),!t.bgColor&&t.placeholder&&e.createElement("img",{src:t.placeholder,alt:t.alt,className:t.placeholderClass,style:{...z,...C}}),w.isVisible&&e.createElement("picture",null,t.webpSrcSet&&e.createElement("source",{type:"image/webp",srcSet:m(t.webpSrcSet),sizes:w.sizes?`${w.sizes}vw`:void 0}),t.srcSet&&e.createElement("source",{srcSet:m(t.srcSet),sizes:w.sizes?`${w.sizes}vw`:void 0}),e.createElement("img",{ref:i,src:t.src,className:t.imgClass,alt:t.alt,sizes:`${w.sizes}vw`,loading:p?"eager":t.loading,onLoad:y,style:{...z,...I}})))}g.defaultProps={loading:"lazy",fadeIn:!0,fit:"cover",position:"center",height:"100%",durationFadeIn:500,alt:""};export{g as Image};
//# sourceMappingURL=index.es.js.map
