{"version":3,"file":"index.js","sources":["../node_modules/@babel/runtime/helpers/esm/slicedToArray.js","../node_modules/@babel/runtime/helpers/esm/arrayWithHoles.js","../node_modules/@babel/runtime/helpers/esm/iterableToArrayLimit.js","../node_modules/@babel/runtime/helpers/esm/nonIterableRest.js","../node_modules/@babel/runtime/helpers/esm/defineProperty.js","../node_modules/@babel/runtime/helpers/esm/objectSpread2.js","../src/support.js","../src/Image.tsx"],"sourcesContent":["import arrayWithHoles from \"./arrayWithHoles\";\nimport iterableToArrayLimit from \"./iterableToArrayLimit\";\nimport nonIterableRest from \"./nonIterableRest\";\nexport default function _slicedToArray(arr, i) {\n  return arrayWithHoles(arr) || iterableToArrayLimit(arr, i) || nonIterableRest();\n}","export default function _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}","export default function _iterableToArrayLimit(arr, i) {\n  if (!(Symbol.iterator in Object(arr) || Object.prototype.toString.call(arr) === \"[object Arguments]\")) {\n    return;\n  }\n\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}","export default function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n}","export default function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}","import defineProperty from \"./defineProperty\";\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nexport default function _objectSpread2(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}","const imageCache = Object.create({});\nexport function getImageCache(id) {\n    return (!!imageCache[id] && imageCache[id][window.location.href]) || null;\n}\nexport function setImageCache(id, sizes) {\n    imageCache[id] = {\n        ...(imageCache[id] || {}),\n        ...{ [window.location.href]: sizes },\n    };\n}\nexport function getSizes(el, src) {\n    if (getImageCache(src)) {\n        return getImageCache(src) || 100;\n    }\n    const min = 32;\n    let currentNode = el;\n    if (currentNode.getBoundingClientRect().width < min) {\n        currentNode = currentNode.parentNode;\n        while (currentNode.tagName !== 'BODY' && currentNode.getBoundingClientRect().width <= min) {\n            currentNode = currentNode.parentNode;\n        }\n    }\n    return Math.ceil((currentNode.getBoundingClientRect().width / window.innerWidth) * 100);\n}\nexport const hasNativeLazyLoadSupport = typeof HTMLImageElement !== 'undefined' && 'loading' in HTMLImageElement.prototype;\nexport const hasIOSupport = window.IntersectionObserver;\nexport function getIO(node, cb) {\n    const observer = new window.IntersectionObserver(([entry]) => {\n        if (entry.isIntersecting || entry.intersectionRatio > 0) {\n            observer.unobserve(node);\n            cb();\n        }\n    }, { rootMargin: '200px' });\n    observer.observe(node);\n    return observer;\n}\nexport const generateSources = (object) => Object.entries(object)\n    .map(([size, url]) => `${url} ${size}w`)\n    .join(', ');\n//# sourceMappingURL=support.js.map","/* eslint max-lines: \"off\" */\nimport React, { CSSProperties, ReactElement, useEffect, useRef, useState } from 'react'\n\nimport {\n  getSizes,\n  getIO,\n  generateSources,\n  hasNativeLazyLoadSupport,\n  hasIOSupport,\n  setImageCache,\n  getImageCache,\n} from './support'\n\ntype Props = {\n  src: string\n  srcSet?: { [x: number]: string }\n  webpSrcSet?: { [x: number]: string }\n  sizes?: number | 'auto'\n  placeholder?: string\n  loading?: 'lazy' | 'auto' | 'eager'\n  aspectRatio?: number\n  height?: string | number\n  critical?: boolean\n  fadeIn?: boolean\n  durationFadeIn?: number\n  className?: string\n  imgStyle?: object\n  imgClass?: string\n  placeholderStyle?: object\n  placeholderClass?: string\n  bgColor?: string\n  alt?: string\n  fit?: 'cover' | 'contain'\n  position?: string\n  transparent?: boolean\n}\n\n// eslint-disable-next-line complexity\nexport function Image(props: Props): ReactElement {\n  /*****************************************************************************\n   * Refs\n   *****************************************************************************/\n  const imgRef = useRef(null)\n  const node: any = useRef(null)\n\n  /*****************************************************************************\n   * Variables\n   *****************************************************************************/\n  const imgHeight = props.aspectRatio ? `${100 / props.aspectRatio}%` : props.height\n  const isCritical = props.loading === 'eager' || props.critical\n  const seenBefore = !!getImageCache(props.src)\n\n  /*****************************************************************************\n   * State\n   *****************************************************************************/\n  const [state, changeState] = useState({\n    sizes: seenBefore ? getImageCache(props.src) : props.sizes,\n    isVisible: seenBefore || isCritical || hasNativeLazyLoadSupport || !hasIOSupport,\n    shouldFadeIn: !seenBefore || props.fadeIn,\n    imgLoaded: seenBefore || false,\n  })\n\n  /*****************************************************************************\n   * Functions\n   *****************************************************************************/\n  const setState = (value: any): void => changeState(state => ({ ...state, ...value }))\n\n  function handleImageLoaded(): void {\n    if (!seenBefore) {\n      setImageCache(props.src, Number(state.sizes))\n      setState({ imgLoaded: true })\n    }\n  }\n\n  /*****************************************************************************\n   * Effects\n   *****************************************************************************/\n  useEffect(() => {\n    if (!seenBefore) {\n      setState({ sizes: props.sizes || getSizes(node.current, props.src) })\n    }\n    const observer = !state.isVisible && getIO(node.current, () => setState({ isVisible: true }))\n\n    if (isCritical) {\n      const img: any = imgRef.current\n      if (img && img.complete) {\n        handleImageLoaded()\n      }\n    }\n\n    return () => {\n      if (observer) {\n        observer.unobserve(node.current)\n      }\n    }\n  }, [])\n\n  /*****************************************************************************\n   * Styles\n   *****************************************************************************/\n  const shouldReveal = !state.shouldFadeIn || state.imgLoaded\n\n  const defaultImageStyles: CSSProperties = {\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    width: '100%',\n    height: '100%',\n    objectFit: props.fit,\n    objectPosition: props.position,\n  }\n\n  const imageStyle: CSSProperties = {\n    opacity: shouldReveal ? 1 : 0,\n    transition: state.shouldFadeIn ? `opacity ${props.durationFadeIn}ms` : 'none',\n    ...props.imgStyle,\n  }\n  const delayHideStyle: CSSProperties = {\n    transition: props.transparent && state.shouldFadeIn ? `opacity ${props.durationFadeIn}ms` : undefined,\n    transitionDelay: props.transparent ? '0' : `${props.durationFadeIn}ms`,\n  }\n  const imagePlaceholderStyle: CSSProperties = {\n    opacity: state.imgLoaded ? 0 : 1,\n    ...(state.shouldFadeIn && delayHideStyle),\n    ...props.imgStyle,\n    ...props.placeholderStyle,\n  }\n\n  /*****************************************************************************\n   * Render\n   *****************************************************************************/\n  return (\n    <div style={{ position: 'relative', overflow: 'hidden' }} className={props.className}>\n      <div style={{ width: '100%', paddingBottom: imgHeight }} ref={node} />\n\n      {props.bgColor && (\n        <div\n          className={props.placeholderClass}\n          style={{\n            backgroundColor: props.bgColor,\n            ...defaultImageStyles,\n            ...imagePlaceholderStyle,\n          }}\n        />\n      )}\n\n      {!props.bgColor && props.placeholder && (\n        <img\n          src={props.placeholder}\n          alt={props.alt}\n          className={props.placeholderClass}\n          style={{\n            ...defaultImageStyles,\n            ...imagePlaceholderStyle,\n          }}\n        />\n      )}\n\n      {state.isVisible && (\n        <picture>\n          {props.webpSrcSet && (\n            <source\n              type=\"image/webp\"\n              srcSet={generateSources(props.webpSrcSet)}\n              sizes={state.sizes ? `${state.sizes}vw` : undefined}\n            />\n          )}\n          {props.srcSet && (\n            <source\n              srcSet={generateSources(props.srcSet)}\n              sizes={state.sizes ? `${state.sizes}vw` : undefined}\n            />\n          )}\n\n          <img\n            ref={imgRef}\n            src={props.src}\n            className={props.imgClass}\n            alt={props.alt}\n            sizes={`${state.sizes}vw`}\n            // eslint-disable-next-line @typescript-eslint/ban-ts-ignore\n            // @ts-ignore\n            loading={isCritical ? 'eager' : props.loading}\n            onLoad={handleImageLoaded}\n            style={{\n              ...defaultImageStyles,\n              ...imageStyle,\n            }}\n          />\n        </picture>\n      )}\n    </div>\n  )\n}\n\nImage.defaultProps = {\n  loading: 'lazy',\n  fadeIn: true,\n  fit: 'cover',\n  position: 'center',\n  height: '100%',\n  durationFadeIn: 500,\n  alt: '',\n}\n"],"names":["_slicedToArray","arr","i","Array","isArray","arrayWithHoles","Symbol","iterator","Object","prototype","toString","call","_arr","_n","_d","_e","undefined","_s","_i","next","done","push","value","length","err","iterableToArrayLimit","TypeError","nonIterableRest","_defineProperty","obj","key","defineProperty","enumerable","configurable","writable","ownKeys","object","enumerableOnly","keys","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","apply","imageCache","create","getImageCache","id","window","location","href","setImageCache","sizes","target","arguments","source","forEach","getOwnPropertyDescriptors","defineProperties","getSizes","el","src","currentNode","getBoundingClientRect","width","parentNode","tagName","Math","ceil","innerWidth","hasNativeLazyLoadSupport","HTMLImageElement","hasIOSupport","IntersectionObserver","generateSources","entries","map","size","url","join","Image","props","imgRef","useRef","node","imgHeight","aspectRatio","height","isCritical","loading","critical","seenBefore","state","changeState","useState","isVisible","shouldFadeIn","fadeIn","imgLoaded","setState","handleImageLoaded","Number","useEffect","current","observer","cb","entry","isIntersecting","intersectionRatio","unobserve","rootMargin","observe","getIO","img","complete","shouldReveal","defaultImageStyles","position","top","left","objectFit","fit","objectPosition","imageStyle","opacity","transition","durationFadeIn","imgStyle","delayHideStyle","transparent","transitionDelay","imagePlaceholderStyle","placeholderStyle","React","style","overflow","className","paddingBottom","ref","bgColor","placeholderClass","backgroundColor","placeholder","alt","webpSrcSet","type","srcSet","imgClass","onLoad","defaultProps"],"mappings":"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"}